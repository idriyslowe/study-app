<%= render partial: "navbar" %>

<div class="shows">
  <div class="row">
    <div class="col-sm-10">
      <h1>Note Page: <%= @note_pages.title %></h1>
      <h4>
        <%= @note_pages.summary %> 
        <%= form_tag "/note_pages/#{@note_pages.id}", method: :patch do %>
        <%= text_field_tag :summary, "Edit Summary" %>
        <%= submit_tag "Submit" %>
        <% end %>
      </h4>
    </div>
  </div>
</div>

<!-- PORTFOLIO SINGLE -->
<div ng-app="app">
  <div ng-controller="notes" ng-init="setup()">
    <section class="module-accordion">
      <div class="container-fluid container-custom" ng-repeat="note in notes">
        <div class="col-sm-12 tags font-serif"> 

        </div> 
          <div class="col-sm-2 tags font-serif" ng-repeat="bookmark in bookmarks">
            <a target="_blank" href="{{bookmark.path}}">{{ bookmark.path }}  {{ bookmark.name}}</a>
          </div> 

          <div class="row">                           
            <!-- COLUMN 8 DIV -->
            <div class="col-md-10">                    
            <!-- ACCORDIONS -->
              <div id="accordion" class="panel-group">               
                <div class="panel panel-default">
                  <div class="panel-heading">
                    <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#support{{note.id}}">
                    {{ note.id }}  {{ note.text}}                         
                    </a></h4>
                  </div>
                  <div id="support{{note.id}}" class="panel-collapse collapse">
                    <div class="panel-body">
                    
                      <textarea name="text" id="text" ng-model="noteText "></textarea>
                      <div>
                        <button class="btn btn-block btn-round btn-dark" ng-click="editNote(noteText, note); noteText = null;">Update Note</button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            <!-- /ACCORDIONS --> 
            </div>
            <!-- /COLUMN 8 DIV -->
            <div class="col-md-2">
              <a ng-click="deleteNote(note)" href="#">Delete</a>
            </div>
          </div>      
      </div>
    </section>
  </div>
</div>

<!-- FORM -->
<div class="row">
  <div class="col-sm-2"></div>
  <div class="col-sm-8">
    <%= form_tag '/notes', method: :post do %>
    <%= hidden_field_tag :note_page_id, @note_pages.id %> 
        <div class="text-center">
          <button type="submit" class="btn btn-block btn-round btn-dark">New Note</button>
        </div>
    <% end %>
  </div>
  <!-- FORM END -->
  <!-- TAGS -->
<div class="col-sm-2 tags font-serif"> 
<%= link_to 'Back to Environment', "/environments/#{@note_pages.environment_id}" %>
</div> 
  <!-- /TAGS -->

<!-- COMMENTS SECTION -->
<div class="shows">

  <div class="col-sm-2 tags font-serif"> 
    <% current_user.bookmarks.each do |bookmark| %>
      <%= link_to bookmark.name, "/bookmarks/#{bookmark.id}", target: "_blank" %>
    <% end %>
  </div> 

  <div class="row">
  <div class="col-sm-10">
    <% @note_pages.comments.each do |comment| %>
      <p><%= comment.user.handle %>   <%= comment.readable_created_at %>   <%= link_to 'Delete', "/comments/#{comment.id}", method: :delete %></p>
      <p><%= comment.text %></p>
      <hr>
    <% end %>
    <%= form_tag '/comments', method: :post do %>
      <%= text_area_tag :text, "..." %>
      <%= hidden_field_tag :note_page_id, @note_pages.id %>
       <div class="text-center">
         <button type="submit" class="btn btn-block btn-round btn-dark">Submit Comment
         </button>
       </div>
    <% end %>
    </div>    
  </div>
</div>
